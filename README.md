# Bio-Lib

A Python library for analyzing protein interactions, calculating Solvent Accessible Surface Area (SASA), predicting binding affinity (prodigy), and identifying residue contacts in JAX.

## Installation

```bash
python3 -m pip install --index-url https://test.pypi.org/simple/ --extra-index-url https://pypi.org/simple/ bio_lib==1.5.1
```

## Core Features 
- **Jax and CPU version of Prodigy**
- **Input Processing with AlphaFold2 Protein embedding**
  - **Residue Classification**: Amino acid categorization (charged, polar, aliphatic) etc.
- **Binding Affinity Prediction in JAX**: Î”G and Kd estimation using (non)-interacting surfaces, customized [PRODIGY](https://github.com/haddocking/prodigy):
  - **SASA Calculation**: JAX-based implementation of Shrake-Rupley algorithm for solvent-accessible surface area calculation (sphere points generated by golden spiral or precomputed sphere from thomson problem). Tested on M1 (batch calculation) and A100 (fully vectorized, a lot of memory needed)
  - **Contact Analysis**: Distance-based residue-residue contact determination within protein complexes


```bash
run-prodigy-custom PRODIGYdataset/ --use-jax # otherwise default is cpu version
```

### Tested on a A100 GPU in Colab
Data contains Ccmpiling time for the GPU version.
![Benchmark Analysis](benchmark_af/v2/ba_val_comp_A100_gpu_cpu.png)

### SASA Values comparisons between freesasa (cpu version) and jax version (1000 Points)
Pearson R: 0.99, Mean difference per atom across all structures in benchmark dataset (n=78): 0.59 A^2. 
![Benchmark Analysis](benchmark_af/v2/sasa_comparison.png)

## Usage Example

```python
# Process single structure
import jax
jax.config.update("jax_enable_x64", True)
from bio_lib.run_prodigy_custom import run
from pathlib import Path

folder = Path("PRODIGYdataset") # folder or file_path with pdb files

res = run(folder, output_dir=Path("results"), sphere_points=100, quiet=True, use_jax=True)
```
